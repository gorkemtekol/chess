<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Georgia', serif; background-color: #ffffff; min-height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        body.hard-mode { background-color: #c0392b; }
        
        /* Alt Bilgi Alanları */
        #version-tag { position: fixed; bottom: 10px; right: 15px; font-size: 11px; color: #999; font-family: sans-serif; letter-spacing: 0.5px; z-index: 3000; }
        
        #info-btn { 
            position: fixed; bottom: 10px; left: 15px; width: 30px; height: 30px; 
            border: 2px solid #000; border-radius: 50%; display: flex; justify-content: center; 
            align-items: center; cursor: pointer; font-weight: bold; font-family: serif; 
            font-style: italic; font-size: 18px; z-index: 3000; background: #fff; transition: 0.2s;
        }
        #info-btn:hover { background: #eee; transform: scale(1.1); }

        /* Pop-up (Modal) Tasarımı */
        .info-modal { 
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); 
            z-index: 4000; justify-content: center; align-items: center; 
        }
        .info-content { 
            background: #fff; border: 3px solid #000; width: 90%; max-width: 450px; 
            max-height: 80vh; overflow-y: auto; padding: 30px; position: relative; 
            box-shadow: 10px 10px 0px #000;
        }
        .close-info { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; font-weight: bold; }
        
        .info-title { font-size: 24px; border-bottom: 2px solid #000; margin-bottom: 15px; padding-bottom: 5px; }
        .info-body { font-size: 14px; line-height: 1.6; color: #333; }
        .info-body a { color: #0066cc; text-decoration: underline; font-weight: bold; }
        
        /* Mail Kutusu Alanı */
        .contact-area { margin-top: 20px; display: flex; align-items: center; gap: 10px; }
        .mail-icon { width: 24px; height: 24px; }
        .email-box { 
            padding: 5px 10px; border: 1px solid #000; background: #f9f9f9; 
            font-family: monospace; font-size: 13px; flex-grow: 1; 
        }

        /* Standart Menüler ve Oyun Stilleri */
        #user-info-area { position: absolute; top: 20px; left: 20px; font-size: 18px; font-weight: bold; color: #000; display: flex; align-items: center; gap: 10px; z-index: 100; }
        #change-name { font-size: 11px; cursor: pointer; text-decoration: underline; color: #666; font-weight: normal; }
        #lang-wrapper { position: absolute; top: 20px; right: 20px; z-index: 2000; }
        #lang-btn { background: #fff; border: 2px solid #000; padding: 8px 15px; cursor: pointer; font-weight: bold; min-width: 120px; text-align: center; }
        #lang-content { display: none; position: absolute; right: 0; background: #fff; border: 2px solid #000; min-width: 120px; }
        #lang-wrapper:hover #lang-content { display: block; }
        .lang-option { padding: 10px; cursor: pointer; font-size: 13px; border-bottom: 1px solid #eee; }
        
        #login-screen { position: fixed; inset: 0; background: #fff; z-index: 1000; display: none; flex-direction: column; justify-content: center; align-items: center; gap: 20px; }
        #login-screen input { padding: 15px; font-size: 20px; border: 3px solid #000; width: 300px; }
        #menu, #difficulty-menu, #side-choice-menu { display: flex; flex-direction: column; align-items: center; gap: 40px; }
        #difficulty-menu, #side-choice-menu, #game { display: none; }
        
        h1 { font-size: 64px; font-weight: bold; letter-spacing: 8px; text-transform: uppercase; }
        .menu-btn { padding: 18px 50px; font-size: 20px; background-color: #d0d0d0; border: 3px solid #000; cursor: pointer; min-width: 280px; }
        
        #game { flex-direction: row; gap: 30px; padding: 20px; align-items: flex-start; }
        #board { display: grid; grid-template-columns: repeat(8, 60px); grid-template-rows: repeat(8, 60px); border: 3px solid #000; }
        #board.flipped { transform: rotate(180deg); }
        #board.flipped .square img { transform: rotate(180deg); }
        .square { width: 60px; height: 60px; display: flex; justify-content: center; align-items: center; position: relative; }
        .white { background-color: #ffffff; }
        .black { background-color: #000000; }
        .square img { width: 50px; height: 50px; z-index: 5; cursor: grab; }

        .right-panel { display: flex; flex-direction: column; gap: 10px; width: 240px; }
        .timer-container { display: flex; background-color: #fff59d; border: 2px solid #000; padding: 10px 0; text-align: center; }
        .timer-box { flex: 1; }
        .timer-digits { font-size: 32px; font-weight: bold; font-family: monospace; }
        .move-sheet { background-color: #f5f5f5; border: 2px solid #000; padding: 10px; height: 160px; overflow-y: auto; }
        
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; z-index: 2000; }
        .modal-content { background: #fff; padding: 40px; border: 3px solid #000; text-align: center; }
    </style>
</head>
<body>

    <div id="info-btn" onclick="toggleInfo(true)">i</div>
    <div id="version-tag">v0.6 Beta | Work In Progress</div>

    <div id="info-modal" class="info-modal">
        <div class="info-content">
            <span class="close-info" onclick="toggleInfo(false)">&times;</span>
            <div class="info-title" id="txt-about-title">Hakkında</div>
            <div class="info-body">
                Made by <b>Görkem TEKOL</b> (a.k.a n0rches, gorkemtekol)<br>
                GitHub project on <a href="https://github.com/gorkemtekol/ai-projects" target="_blank">github.com/gorkemtekol/ai-projects</a>.<br><br>
                For more information and support,
                
                <div class="contact-area">
                    <svg class="mail-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                        <polyline points="22,6 12,13 2,6"></polyline>
                    </svg>
                    <div class="email-box">gorkemtekol@gmail.com</div>
                </div>
            </div>
        </div>
    </div>

    <div id="user-info-area">
        <span id="user-display-name"></span>
        <span id="change-name" onclick="forceNewName()"></span>
    </div>

    <div id="lang-wrapper">
        <div id="lang-btn">Language</div>
        <div id="lang-content">
            <div class="lang-option" onclick="changeLang('en')">English</div>
            <div class="lang-option" onclick="changeLang('tr')">Türkçe</div>
            <div class="lang-option" onclick="changeLang('es')">Español</div>
            <div class="lang-option" onclick="changeLang('de')">Deutsch</div>
            <div class="lang-option" onclick="changeLang('ru')">Русский</div>
            <div class="lang-option" onclick="changeLang('fr')">Français</div>
        </div>
    </div>

    <div id="login-screen">
        <h1 id="txt-welcome">HOŞ GELDİN</h1>
        <input type="text" id="username-input" placeholder="...">
        <button class="menu-btn" id="btn-save" onclick="saveName()">KAYDET</button>
    </div>

    <div id="menu">
        <h1 id="txt-logo">SATRANÇ</h1>
        <div class="menu-buttons">
            <button class="menu-btn" id="btn-ai" onclick="prepare('ai')"></button>
            <button class="menu-btn" id="btn-human" onclick="prepare('human')"></button>
        </div>
    </div>

    <div id="difficulty-menu">
        <h1 id="txt-diff-title">ZORLUK</h1>
        <button class="menu-btn" id="btn-easy" onclick="setDiff('easy')"></button>
        <button class="menu-btn" id="btn-med" onclick="setDiff('medium')"></button>
        <button class="menu-btn" id="btn-hard" onclick="showHard()"></button>
    </div>

    <div id="side-choice-menu">
        <h1 id="txt-side-title">RENK SEÇ</h1>
        <div class="side-buttons">
            <button class="side-btn" onclick="start('w')"><img src="https://images.chesscomfiles.com/chess-themes/pieces/neo/150/wk.png"></button>
            <button class="side-btn" onclick="start('b')"><img src="https://images.chesscomfiles.com/chess-themes/pieces/neo/150/bk.png"></button>
        </div>
    </div>

    <div id="game">
        <div class="game-left">
            <div style="display:flex; justify-content:space-between; width:480px; margin-bottom:10px;">
                <span id="turn-txt">...</span>
                <button onclick="location.reload()">MENÜ</button>
            </div>
            <div id="board"></div>
        </div>
        <div class="right-panel">
            <div class="timer-container">
                <div class="timer-box">
                    <div id="timer-label-1" style="font-size:11px; font-weight:bold;">P1</div>
                    <div class="timer-digits" id="timer-1">0:00</div>
                </div>
                <div class="timer-box" style="border-left:1px solid #000;">
                    <div id="timer-label-2" style="font-size:11px; font-weight:bold;">P2</div>
                    <div class="timer-digits" id="timer-2">0:00</div>
                </div>
            </div>
            <div class="move-sheet" id="w-moves"></div>
            <div class="move-sheet" id="b-moves"></div>
        </div>
    </div>

    <div id="over-modal" class="modal"><div class="modal-content"><h2 id="over-txt"></h2><br><button class="menu-btn" onclick="location.reload()">TAMAM</button></div></div>
    <div id="hard-modal" class="modal"><div class="modal-content"><h2>ZOR MOD? EMİN MİSİN?</h2><br><button onclick="setDiff('hard')">EVET</button> <button onclick="location.reload()">HAYIR</button></div></div>

    <script>
        const translations = {
            tr: { about: "Hakkında", welcome: "HOŞ GELDİN", save: "KAYDET", logo: "SATRANÇ", ai: "AI", human: "İKİ OYUNCU", diff: "ZORLUK", easy: "KOLAY", med: "ORTA", hard: "ZOR", side: "TARAF SEÇ", white: "Beyaz", black: "Siyah", user: "Kullanıcı", change: "[Değiştir]", turnW: "BEYAZDA", turnB: "SİYAHDA", placeholder: "İsim yazın..." },
            en: { about: "About", welcome: "WELCOME", save: "SAVE", logo: "CHESS", ai: "AI", human: "TWO PLAYERS", diff: "DIFFICULTY", easy: "EASY", med: "MEDIUM", hard: "HARD", side: "PICK COLOR", white: "White", black: "Black", user: "User", change: "[Change]", turnW: "WHITE'S TURN", turnB: "BLACK'S TURN", placeholder: "Write name..." },
            es: { about: "Acerca de", welcome: "BIENVENIDO", save: "GUARDAR", logo: "AJEDREZ", ai: "AI", human: "DOS JUGADORES", diff: "DIFICULTAD", easy: "FÁCIL", med: "MEDIO", hard: "DIFÍCIL", side: "ELEGIR COLOR", white: "Blanco", black: "Negro", user: "Usuario", change: "[Cambiar]", turnW: "TURNO BLANCO", turnB: "TURNO NEGRO", placeholder: "Escribe nombre..." },
            de: { about: "Über", welcome: "WILLKOMMEN", save: "SPEICHERN", logo: "SCHACH", ai: "AI", human: "ZWEI SPIELER", diff: "STUFE", easy: "LEICHT", med: "MITTEL", hard: "SCHWER", side: "FARBE WÄHLEN", white: "Weiß", black: "Schwarz", user: "Benutzer", change: "[Ändern]", turnW: "WEISS AM ZUG", turnB: "SCHWARZ AM ZUG", placeholder: "Name schreiben..." },
            ru: { about: "О программе", welcome: "ДОБРО ПОЖАЛОВАТЬ", save: "СОХРАНИТЬ", logo: "ШАХМАТЫ", ai: "AI", human: "ДВА ИГРОКА", diff: "СЛОЖНОСТЬ", easy: "ЛЕГКО", med: "СРЕДНЕ", hard: "СЛОЖНО", side: "ВЫБОР ЦВЕТА", white: "Белые", black: "Черные", user: "Игрок", change: "[Изм.]", turnW: "ХОД БЕЛЫХ", turnB: "ХОД ЧЕРНЫХ", placeholder: "Введите имя..." },
            fr: { about: "À propos", welcome: "BIENVENUE", save: "SAUVER", logo: "ÉCHECS", ai: "AI", human: "DEUX JOUEURS", diff: "DIFFICULTÉ", easy: "FACILE", med: "MOYEN", hard: "DIFFICILE", side: "CHOISIR COULEUR", white: "Blanc", black: "Noir", user: "Utilisateur", change: "[Changer]", turnW: "AUX BLANCS", turnB: "AUX NOIRS", placeholder: "Écrire le nom..." }
        };

        const IMG = {
            'wK': 'https://images.chesscomfiles.com/chess-themes/pieces/neo/150/wk.png', 'wQ': 'https://images.chesscomfiles.com/chess-themes/pieces/neo/150/wq.png',
            'wR': 'https://images.chesscomfiles.com/chess-themes/pieces/neo/150/wr.png', 'wB': 'https://images.chesscomfiles.com/chess-themes/pieces/neo/150/wb.png',
            'wN': 'https://images.chesscomfiles.com/chess-themes/pieces/neo/150/wn.png', 'wP': 'https://images.chesscomfiles.com/chess-themes/pieces/neo/150/wp.png',
            'bK': 'https://images.chesscomfiles.com/chess-themes/pieces/neo/150/bk.png', 'bQ': 'https://images.chesscomfiles.com/chess-themes/pieces/neo/150/bq.png',
            'bR': 'https://images.chesscomfiles.com/chess-themes/pieces/neo/150/br.png', 'bB': 'https://images.chesscomfiles.com/chess-themes/pieces/neo/150/bb.png',
            'bN': 'https://images.chesscomfiles.com/chess-themes/pieces/neo/150/bn.png', 'bP': 'https://images.chesscomfiles.com/chess-themes/pieces/neo/150/bp.png'
        };

        let board = [], turn = 'w', myColor = 'w', mode = '', over = false, sel = null, moves = [];
        let userName = localStorage.getItem('chess_username');
        let lang = localStorage.getItem('chess_lang') || 'tr';
        let timerW = 0, timerB = 0, timerInterval;

        window.onload = () => {
            updateUI();
            if (!userName) document.getElementById('login-screen').style.display = 'flex';
            else { showUsername(); document.getElementById('menu').style.display = 'flex'; }
        };

        function toggleInfo(show) {
            document.getElementById('info-modal').style.display = show ? 'flex' : 'none';
        }

        function changeLang(l) {
            lang = l;
            localStorage.setItem('chess_lang', l);
            updateUI();
        }

        function updateUI() {
            const t = translations[lang];
            document.getElementById('txt-about-title').innerText = t.about;
            document.getElementById('txt-welcome').innerText = t.welcome;
            document.getElementById('btn-save').innerText = t.save;
            document.getElementById('username-input').placeholder = t.placeholder;
            document.getElementById('txt-logo').innerText = t.logo;
            document.getElementById('btn-ai').innerText = t.ai;
            document.getElementById('btn-human').innerText = t.human;
            document.getElementById('txt-diff-title').innerText = t.diff;
            document.getElementById('btn-easy').innerText = t.easy;
            document.getElementById('btn-med').innerText = t.med;
            document.getElementById('btn-hard').innerText = t.hard;
            document.getElementById('txt-side-title').innerText = t.side;
            document.getElementById('change-name').innerText = t.change;
            if (userName) showUsername();
            updateTurnTxt();
        }

        function showUsername() { document.getElementById('user-display-name').innerText = (translations[lang].user || "User") + ": " + userName; }
        function forceNewName() { localStorage.removeItem('chess_username'); location.reload(); }
        function saveName() {
            const input = document.getElementById('username-input').value.trim();
            if (input) { localStorage.setItem('chess_username', input); userName = input; showUsername(); document.getElementById('login-screen').style.display = 'none'; document.getElementById('menu').style.display = 'flex'; }
        }

        function prepare(m) { mode = m; document.getElementById('menu').style.display = 'none'; if(m === 'ai') document.getElementById('difficulty-menu').style.display = 'flex'; else document.getElementById('side-choice-menu').style.display = 'flex'; }
        function setDiff(d) { if(d === 'hard') document.body.classList.add('hard-mode'); document.getElementById('difficulty-menu').style.display = 'none'; document.getElementById('hard-modal').style.display = 'none'; document.getElementById('side-choice-menu').style.display = 'flex'; }
        function showHard() { document.getElementById('hard-modal').style.display = 'flex'; }

        function start(c) {
            myColor = c;
            const bEl = document.getElementById('board');
            if(c === 'b') bEl.classList.add('flipped');
            const label1 = document.getElementById('timer-label-1');
            const label2 = document.getElementById('timer-label-2');
            if(mode === 'ai') {
                label1.innerText = (c === 'w' ? userName : "AI");
                label2.innerText = (c === 'b' ? userName : "AI");
            }
            document.getElementById('side-choice-menu').style.display = 'none';
            document.getElementById('game').style.display = 'flex';
            init();
            startTimer();
            if(mode === 'ai' && myColor === 'b') setTimeout(aiMove, 600);
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                if (over) return;
                if (turn === 'w') timerW++; else timerB++;
                const fmt = s => `${Math.floor(s/60)}:${(s%60).toString().padStart(2,'0')}`;
                document.getElementById('timer-1').innerText = fmt(timerW);
                document.getElementById('timer-2').innerText = fmt(timerB);
            }, 1000);
        }

        function init() {
            board = [
                ['bR','bN','bB','bQ','bK','bB','bN','bR'], ['bP','bP','bP','bP','bP','bP','bP','bP'],
                [null,null,null,null,null,null,null,null], [null,null,null,null,null,null,null,null],
                [null,null,null,null,null,null,null,null], [null,null,null,null,null,null,null,null],
                ['wP','wP','wP','wP','wP','wP','wP','wP'], ['wR','wN','wB','wQ','wK','wB','wN','wR']
            ];
            draw();
        }

        function draw() {
            const bEl = document.getElementById('board'); bEl.innerHTML = '';
            for(let r=0; r<8; r++) for(let c=0; c<8; c++) {
                const s = document.createElement('div');
                s.className = `square ${(r+c)%2===0?'white':'black'}`;
                if(board[r][c]) {
                    const img = document.createElement('img');
                    img.src = IMG[board[r][c]];
                    img.onclick = () => { if(!over && board[r][c][0]===turn) { sel={r,c}; moves=getLegals(r,c,board); draw(); } };
                    s.appendChild(img);
                }
                s.onclick = () => {
                    if(sel && moves.some(m=>m.r===r && m.c===c)) doMove(sel.r, sel.c, r, c);
                };
                if(sel?.r===r && sel?.c===c) s.style.background = "yellow";
                if(moves.some(m=>m.r===r && m.c===c)) {
                    const dot = document.createElement('div');
                    dot.style = "width:15px; height:15px; background:rgba(0,255,0,0.5); border-radius:50%; position:absolute; z-index:10;";
                    s.appendChild(dot);
                }
                bEl.appendChild(s);
            }
        }

        function doMove(fr, fc, tr, tc) {
            board[tr][tc] = board[fr][fc]; board[fr][fc] = null;
            turn = turn === 'w' ? 'b' : 'w';
            sel = null; moves = []; draw(); check();
            if(!over && mode === 'ai' && turn !== myColor) setTimeout(aiMove, 600);
        }

        function getBase(r, c, b) {
            const p = b[r][c]; if(!p) return [];
            const m = [], col = p[0], t = p[1];
            const add = (nr, nc) => {
                if(nr>=0 && nr<8 && nc>=0 && nc<8) {
                    if(!b[nr][nc] || b[nr][nc][0] !== col) { m.push({r:nr, c:nc}); return !b[nr][nc]; }
                } return false;
            };
            if(t==='P') {
                const d = col==='w'?-1:1;
                if(b[r+d] && !b[r+d][c]) { m.push({r:r+d, c:c}); if(((col==='w'&&r===6)||(col==='b'&&r===1)) && !b[r+2*d][c]) m.push({r:r+2*d, c:c}); }
                [[-1,d],[1,d]].forEach(o => { if(b[r+o[1]]?.[c+o[0]] && b[r+o[1]][c+o[0]][0] !== col) m.push({r:r+o[1], c:c+o[0]}); });
            } else if(t==='N') [[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]].forEach(o => add(r+o[0], c+o[1]));
            else if(t==='K') [[0,1],[0,-1],[1,0],[-1,0],[1,1],[1,-1],[-1,1],[-1,-1]].forEach(o => add(r+o[0], c+o[1]));
            else {
                const ds = (t==='R')?[[0,1],[0,-1],[1,0],[-1,0]]:(t==='B')?[[1,1],[1,-1],[-1,1],[-1,-1]]:[[0,1],[0,-1],[1,0],[-1,0],[1,1],[1,-1],[-1,1],[-1,-1]];
                ds.forEach(d => { let nr=r+d[0], nc=c+d[1]; while(add(nr, nc)) { nr+=d[0]; nc+=d[1]; } });
            }
            return m;
        }

        function getLegals(r, c, b) {
            return getBase(r, c, b).filter(m => {
                const tmp = b.map(row => [...row]); tmp[m.r][m.c] = tmp[r][c]; tmp[r][c] = null;
                return !inCheck(b[r][c][0], tmp);
            });
        }

        function inCheck(col, b) {
            let kr, kc; for(let r=0; r<8; r++) for(let c=0; c<8; c++) if(b[r][c]===col+'K'){kr=r; kc=c;}
            const opp = col==='w'?'b':'w';
            for(let r=0; r<8; r++) for(let c=0; c<8; c++) if(b[r][c]?.startsWith(opp)) if(getBase(r,c,b).some(m=>m.r===kr && m.c===kc)) return true;
            return false;
        }

        function check() {
            const has = board.some((row, r) => row.some((p, c) => p?.startsWith(turn) && getLegals(r, c, board).length > 0));
            if(!has) { over = true; document.getElementById('over-txt').innerText = turn==='w' ? "SİYAH KAZANDI" : "BEYAZ KAZANDI"; document.getElementById('over-modal').style.display = 'flex'; }
            updateTurnTxt();
        }

        function updateTurnTxt() { document.getElementById('turn-txt').innerText = turn==='w' ? translations[lang].turnW : translations[lang].turnB; }

        function aiMove() {
            let mvs = [];
            for(let r=0; r<8; r++) for(let c=0; c<8; c++) if(board[r][c]?.startsWith(turn)) getLegals(r,c,board).forEach(m=>mvs.push({fr:r, fc:c, tr:m.r, tc:m.c, cap:board[m.r][m.c]}));
            if(!mvs.length) return;
            mvs.sort((a,b) => (b.cap?1:0)-(a.cap?1:0));
            const b = mvs[0]; doMove(b.fr, b.fc, b.tr, b.tc);
        }
    </script>
</body>
</html>
